process CaloTest  = {

	service = MessageLogger	{
		untracked vstring destinations = {"cout"} 
		untracked vstring categories = { "HFShower" }

		untracked PSet cout = { 
			untracked PSet default = { untracked int32 limit = 0 }
			untracked PSet HFShower = { untracked int32 limit =-1} 
		}
	}

	untracked PSet maxEvents = {untracked int32 input = -1}
	source = PoolSource {
		untracked vstring fileNames =
               {
               'file:/afs/cern.ch/cms/data/CMSSW/Validation/HcalHits/data/1_4_x/mc_pi+100_etaphi344.root'
               }
		untracked uint32 debugVebosity = 11
		untracked bool   debugFlag     = true
	}

        service = Timing {}

	service = RandomNumberGeneratorService {
		untracked uint32 sourceSeed = 135799753
		PSet moduleSeeds = {
			untracked uint32 VtxSmeared = 123456789
			untracked uint32 g4SimHits = 9876
		}
	}

	include "IOMC/EventVertexGenerators/data/VtxSmearedGauss.cfi"
	replace VtxSmeared.SigmaX = 0.00001
	replace VtxSmeared.SigmaY = 0.00001
	replace VtxSmeared.SigmaZ = 0.00001

	#Magnetic Field 		
	include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

	#Geometry
	include "Geometry/CMSCommonData/data/ecalhcalGeometryXML.cfi"

	module USER = PoolOutputModule {untracked string fileName ="simevent_HF.root"} 
	
	include "SimG4Core/Application/data/g4SimHits.cfi"
	replace g4SimHits.UseMagneticField = false
	replace g4SimHits.StackingAction.TrackNeutrino = true
	replace g4SimHits.Physics.type = "SimG4Core/Physics/QGSP_EMV"
	replace g4SimHits.G4Commands = {"/physics_engine/neutron/energyLimit 0 keV",
					"/physics_engine/neutron/timeLimit 0.01 ms"}
	replace g4SimHits.HFShowerLibrary = {
		FileInPath FileName = "SimG4CMS/Calo/data/hfshowerlibrary_lhep_140_edm.root"
		string TreeEMID  = "emParticles"
		string TreeHadID = "hadParticles"
		double BackProbability = 0.2
		untracked string BranchEvt  = "HFShowerLibraryEventInfos_hfshowerlib_HFShowerLibraryEventInfo"
		untracked string BranchPre  = "HFShowerPhotons_hfshowerlib_"
		untracked string BranchPost = "_R.obj"
		untracked bool   Verbosity  = true
	}
	replace g4SimHits.Watchers = {
                    {string type                   = "SimG4HcalValidation"
                     PSet SimG4HcalValidation = {
                        int32   InfoLevel       = 2
                        bool    HcalClusterOnly = false
                        bool    HcalSampling    = true
                        double  ConeSize        = 0.5
                        double  EcalHitThreshold= 1e-20
                        double  HcalHitThreshold= 1e-20
                        double  TimeLowLimit    = 0.
                        double  TimeUpLimit     = 999.
                        double  JetThreshold    = 5.0
                        double  Eta0            = 0.3045
                        double  Phi0            = 0.3054
                        vstring Names           = {"HcalHits", "EcalHitsEB",
                                                   "EcalHitsEE", "EcalHitsES"}
			untracked string LabelLayerInfo = "HcalInfoLayer"
			untracked string LabelNxNInfo   = "HcalInfoNxN"
			untracked string LabelJetsInfo  = "HcalInfoJets"
                        }
                    }
                }


        include "DQMServices/Core/data/DQM.cfg"
        replace DQM.collectorHost = ""

	include "Validation/HcalHits/test/data/HcalHitValidation.cfi"
	replace hcalHitValid.OutputFile    = "valid_HF.root"

	path p1 = { VtxSmeared, g4SimHits, hcalHitValid }
	endpath outpath = { USER }

}		
